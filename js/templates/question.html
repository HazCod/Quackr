<div id="overviewpage"></div>
<div data-role="page">
    <!-- SLIDEMENU START -->
    <div data-role="panel" id="panel" data-position="left" data-theme="a" data-display="push">

        <div class="wrapmenu">
            {{> menu}}
        </div>
    </div>
    <!-- SLIDEMENU STOP -->
    <div data-role="header">
        <a data-iconpos="notext" href="#panel" data-role="button" data-icon="flat-menu"></a>
        <h1>Question</h1>
        <a data-iconpos="notext" data-role="button" data-icon="home" title="Home" href="#profile"></a>
    </div>

    <div id="pb_question"></div>

    <div data-role="content" role="main">
        <div class="centerdiv">
            {{> messages}}
            <br>
            {{#with question}}
            <div class="innerdiv">
                <div data-role="fieldcontain">
                    <div id="pb_question"></div>
                </div>
                <div class="ui-corner-all custom-corners">
                    <div class="ui-bar ui-bar-a">
                        <h3>You are quackin' <strong>{{questions.0.category}}</strong> on difficulty <strong>Level {{lvl}}</strong></h3>
                    </div>
                    <div class="ui-body ui-body-a">
                        <p>
                        {{question}}
                        </p>
                        <br>
                        <div class="row">
                            {{#each propanswers}}
                            <label class="radio answer">
                                <input type="radio" name="answer" id="answer-{{{id}}}" value="{{{id}}}" data-toggle="radio">
                                <span class="icons">
                                    <span class="icon-unchecked"></span>
                                    <span class="icon-checked"></span>
                                </span>
                                {{{propanswer}}}
                            </label>
                            {{/each}}
                        </div>
                        <p id="deviceIsReady">
                        Rather have another question? Just give your phone a good shake!
                        </p>
                        <p id="loader" class="show-page-loading-msg" data-theme="b" data-textonly="true"
                        data-textvisible="true" data-msgtext="Fetching a new question"
                        data-icon="arrow-r" data-iconpos="right"></p>
                        <br>
                        <div class="row">
                            <button id="go" data-icon="flat-checkround" data-theme="b" onClick="javascript:guess('{{catid}}','{{id}}');" disabled>Go</button>
                            <!-- "javascript:redirect('guess?c={{catid}}&amp;q={{id}}&amp;a=' + selected);" -->
                        </div>
                    </div>
                </div>
            </div>
            {{/with}}
        </div>
        <script type="text/javascript">
$("input[type=radio]").on( "click", function() {
        selected = $(this).val();
        $('#go').removeAttr('disabled');
        });

function guess(catid, questionid){
    //All possible correct answers
    var answers = [ {{#each question.correctanswer}} '{{id}}', {{/each}} ];
    log('Possible answers:');
    log(answers);
    log('Selected: ' + selected);
    if (selected){
        var correct = false;
        //Support for multiple possibilities
        answers.forEach(function (entry){
                log('answer ' + entry+ ' == answered ' + selected + ' ?');
                if (entry === selected){
                correct = true;
                }
                });

        if (correct){
            log('Question correct!');
            app.model.correct(questionid);
            redirect('next?id=' + catid);
        } else {
            log('Question incorrect!');
            app.model.incorrect(questionid);
            setErrorMessage("Woops! You got it wrong! Try again...");
            redirect('question?id=' + questionid);
        }
    }
}
        </script>
